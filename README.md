# 맞춤형 대출 상품 추천으로인한 수익 향상 및 신용등급 예측을 통한 신규 고객 유입

## 목차

- 데이터 정제
- 파생변수 생성
- EDA
- 개선 방안
- 모델링
  - 변수 선택
  - 데이터 전처리
  - 다층 퍼셉트론
  - 성능측정
  - 과학습 방지
  - 성능 향상 프로세스
  - 풀프로세스
- 한계점

이 프로젝트는 고객 데이터를 기반으로 신용등급을 예측하는 모델을 개발하는 것을 목표로 합니다. 이를 통해 맞춤형 대출 상품 추천으로 수익을 향상시키고 신규 고객 유치를 목표로 합니다.

## 베이스라인 모델 구축 과정

신용등급 예측을 위한 베이스라인 모델 구축 과정은 다음과 같습니다:

### 1. 데이터 로드 및 탐색
- pandas를 사용하여 CSV 파일에서 데이터 로드
- 기본적인 데이터 탐색 (head(), info(), describe() 등 사용)

### 2. 데이터 전처리
- 이상치 : NM ,No Data , not specifid , 개인 신용 이력 연수 열 삭제
- Cluster 변수 생성성
- 레이블 인코딩: sklearn의 LabelEncoder를 사용하여 범주형 변수를 숫자로 변환
- 특성 스케일링: sklearn의 StandardScaler를 사용하여 수치형 특성들의 스케일 조정
- 미니배치 크기 64

### 3. 클러스터링
- K-means 알고리즘을 사용하여 고객 세그먼트 생성
- 엘보우 방법을 통한 최적의 클러스터 수 결정

### 4. 언더샘플링
- Tomek Links 방법을 사용하여 클래스 불균형 문제 해결

### 5. 모델 구축
- TensorFlow와 Keras를 사용한 다층 퍼셉트론(MLP) 신경망 모델 구축
- 배치 정규화와 드롭아웃을 적용하여 과적합 방지

### 6. 모델 학습 및 평가
- Adam 옵티마이저와 CrossEntropyLoss를 사용하여 모델 학습
- 학습 및 검증 정확도를 통한 모델 성능 평가

### 7. EDA
- matplotlib과 seaborn을 사용한 데이터 분포 및 관계 시각화 (boxplot , vilolinplot , heatmap ,linplot , barplot , mosaic)
- 학습 곡선 (손실 및 정확도) 시각화

### 8. 특성 중요도 분석
- Random Forest를 사용한 특성 중요도 계산 및 시각화

이 베이스라인 모델은 데이터 전처리부터 모델링, 평가까지 머신러닝 프로젝트의 전반적인 과정을 포함하고 있으며, 특히 신경망 모델을 사용한 분류 문제 해결에 초점을 맞추고 있습니다.

## 주요 모델링 기법 설명

1. 모델 구조
   - 총 5개의 층으로 구성: 3개의 은닉층과 1개의 입,출력층
     - 128,256,128,64,3
   - 은닉층에서는 ReLU 활성화 함수 사용
   - 출력층에서는 ReLu 활성화 함수 사용 (다중 분류)
   - 배치 정규화(BatchNormalization)로 학습 안정화
   - 드롭아웃(Dropout 0.3)으로 과적합 방지
   - he 초기화 - ReLu사용해서 활용으로 과적합 방지

2. 모델 컴파일
   - Adam 옵티마이저 사용 (학습률 0.0005)
   - CrossEntropyLoss 손실 함수 사용
   - 정확도(accuracy)를 평가 지표로 사용 (train : 76% , test : 77%)

3. 모델 학습
   - 300 에폭 동안 학습
   - 배치 크기 64 사용
   - Early stop 적용 (15)
   - 검증 데이터를 이용한 성능 모니터링(tqdm 활용)

4. 모델 평가
   - 검증 데이터셋으로 모델의 손실과 정확도 평가

5. 예측 및 결과 시각화
   - 테스트 데이터에 대한 예측 수행
   - 혼동행렬 시각화

6. 학습 과정 시각화
   - 훈련 및 검증 손실, 정확도의 변화를 시각화

이러한 기법들을 통해 신용등급 예측을 위한 딥러닝 모델을 구축하고, 학습 및 평가를 수행하였습니다. 배치 정규화와 드롭아웃을 사용하여 모델의 일반화 성능을 향상시키고, 학습 과정을 시각화하여 모델의 성능 변화를 쉽게 파악할 수 있도록 하였습니다.

### 한계점
- 언더 샘플링 후에도 클래스 불균형이 일어나서 StratifiedKfold 사용 -> 성능이 더 떨어짐
- 파생변수로 추가로 성능 개선 예상
- 변수 중요도에 따른 학습 예상과 일치 하지 않았음 -> 중요 변수로 학습 시 전체 변수 학습보다 성능 떨어짐 
- 정형 데이터라 딥러닝 보단 머신러닝에 적합 예상


#### 후기
- 개인 프로젝트로 감안했을 때 전체적인 퀄리티에 만족 + 파생변수 추가 및 실제 이론과 다른 수치가 나와서 다양한 기법을 돌려봐야한다는게 아쉬움


